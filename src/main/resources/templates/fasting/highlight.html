<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layouts/basic.html}">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>공복혈당 하이라이트</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.12.9/dist/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
</head>

<div layout:fragment="content">
    <div class="center-width">
        <h2>혈당 하이라이트 페이지</h2>
        <p th:if="${startDate != null and endDate != null}"
           th:text="'기간: ' + ${#temporals.format(startDate, 'yyyy. MM. dd')} + ' ~ '
       + ${#temporals.format(endDate, 'yyyy. MM. dd')}"></p>
        <table class="table table-bordered">

            <thead>
            <tr>
                <th scope="col">날짜</th>
                <th scope="col">공복</th>
                <th scope="col">아침</th>
                <th scope="col">점심</th>
                <th scope="col">저녁</th>
            </tr>
            </thead>
            <tbody>
                <!-- 행이 아니라 각 열이 반복되므로 단일 행만 있으면 됩니다. -->
                <tr th:each="data, stat : ${fastingDataList}">
                    <td th:text="${data.registDate.dayOfMonth}"></td>
                    <td th:text="${data.emptyData}"></td>
                    <!-- 아침 데이터 -->
                    <td th:if="${morningData.size() > stat.index}" th:text="${morningData[stat.index].afterBlood}">N/A</td>
                    <td th:unless="${morningData.size() > stat.index}">N/A</td>

                    <!-- 점심 데이터 -->
                    <td th:if="${afternoonData.size() > stat.index}" th:text="${afternoonData[stat.index].afterBlood}">N/A</td>
                    <td th:unless="${afternoonData.size() > stat.index}">N/A</td>

                    <!-- 저녁 데이터 -->
                    <td th:if="${eveningData.size() > stat.index}" th:text="${eveningData[stat.index].afterBlood}">N/A</td>
                    <td th:unless="${eveningData.size() > stat.index}">N/A</td>
                </tr>
                <tr class="table-active">
                    <td>평균</td>
                    <td th:text="${averageEmptyData}"></td>
                    <td th:text="${averageMorningData}"></td>
                    <td th:text="${averageAfternoon}"></td>
                    <td th:text="${averageEvening}"></td>
                </tr>
                <tr class="table-danger">
                    <td>최고</td>
                    <td th:text="${maxEmptyData}"></td>
                    <td th:text="${maxMorningData}"></td>
                    <td th:text="${maxAfternoonData}"></td>
                    <td th:text="${maxEveningData}"></td>
                </tr>
                <tr class="table-success">
                    <td>최저</td>
                    <td th:text="${minEmptyData}"></td>
                    <td th:text="${minMorningData}"></td>
                    <td th:text="${minAfternoonData}"></td>
                    <td th:text="${minEveningData}"></td>
                </tr>
            </tbody>
        </table>
    </div>
</div>

<script layout:fragment="script" th:inline="javascript"></script>